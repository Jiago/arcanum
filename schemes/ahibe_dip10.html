<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">









<html>
  <head>
    <title>arcanum - 
        Java Pairing and Lattice Based Cryptography Library : Schemes - Fully Secure Anonymous HIBE and Secret-Key Anonymous IBE with Short Ciphertexts</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
          <meta name="author" content="Angelo De Caro" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="keywords" content="arcanum, jpbc, pbc, pairing, lattice, multilinear maps, bilinear maps" />
      </head>
  <body class="composite">
<!--    <div id="banner">
        <a href="http://gas.dia.unisa.it/projects/arcanum/" id="bannerLeft">
            <img id="bannerImage" src="http://gas.dia.unisa.it/projects/arcanum/images/banners/banner_4.jpg" alt="" width="1124"/>
        </a>
        <div class="clear">
        <hr/>
      </div>
    </div>  -->
    <div id="breadcrumbs">
          
  

  
    
            
  
            <div class="xleft">
        Last Published: 2014-10-22
                  &nbsp;| Version: 1.0.0
                      </div>
            <div class="xright">
                <a href="http://crypto.stanford.edu/pbc/">PBC
            </a>
          |
          <a href="https://github.com/adecaro/arcanum">GitHub
            </a>
            </div>
        <div class="xcenter">
          Java Pairing and Lattice Based Cryptography Library (Arcanum)
        </div>
      <div class="clear">
        <hr/>
      </div>
    </div>

    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
            
  
                   <h5>Arcanum</h5>
        <ul>
              
  
  <li class="none">
    
          <a href="../index.html">Introduction</a>
        </li>
              
  
  <li class="none">
    
          <a href="../download.html">Download</a>
        </li>
              
  
  <li class="none">
    
          <a href="../buildHowto.html">Build HowTo</a>
        </li>
              
  
  <li class="none">
    
          <a href="../contact.html">Contact</a>
        </li>
              
  
  <li class="none">
    
          <a href="../faq.html">FAQ</a>
        </li>
              
  
  <li class="none">
    
          <a href="../java-docs/api/index.html">Java Docs</a>
        </li>
          </ul>
          <h5>Basic Concepts</h5>
        <ul>
              
  
  <li class="none">
    
          <a href="../docs/field.html">Field</a>
        </li>
              
          
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
      
  <li class="expanded">
    
          <a href="../docs/element.html">Element</a>
                <ul>
                  
  
  <li class="none">
    
          <a href="../docs/element.html#initializing">Initializing</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/element.html#assigning">Assigning</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/element.html#arithmetic">Arithmetic</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/element.html#exponentiation">Exponentiation</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/element.html#comparing">Comparing</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/element.html#io">Import/Export</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/element.html#immutable">Immutable</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/element.html#preprocessing">Preprocessing</a>
        </li>
              </ul>
        </li>
          </ul>
          <h5>Linear Maps</h5>
        <ul>
              
  
  <li class="none">
    
          <a href="../docs/linearmaps.html#initializing">Initializing</a>
        </li>
              
  
  <li class="none">
    
          <a href="../docs/linearmaps.html#applying">Applying</a>
        </li>
              
  
  <li class="none">
    
          <a href="../docs/linearmaps.html#preprocessing">Preprocessing</a>
        </li>
              
          
              
      
            
      
            
      
            
      
            
      
            
      
            
      
                  
      
            
      
                    
      
  <li class="expanded">
    
          <a href="../docs/pg.html">Parameter Generators</a>
                <ul>
                  
          
              
      
            
      
            
      
            
      
            
      
            
      
              
      
  <li class="expanded">
    
          <a href="../docs/ecpg.html">Bilinear Maps</a>
                <ul>
                  
  
  <li class="none">
    
          <a href="../docs/ecpg.html#TypeA">Type A</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/ecpg.html#TypeA1">Type A1</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/ecpg.html#TypeD">Type D</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/ecpg.html#TypeE">Type E</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/ecpg.html#TypeF">Type F</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../docs/ecpg.html#TypeG">Type G</a>
        </li>
              </ul>
        </li>
                  
          
              
      
              
      
  <li class="expanded">
    
          <a href="../docs/mmpg.html">Multilinear Maps</a>
                <ul>
                  
  
  <li class="none">
    
          <a href="../docs/mmpg.html#ctl13">Over the Integers [CTL'13]</a>
        </li>
              </ul>
        </li>
              </ul>
        </li>
              
  
  <li class="none">
    
          <a href="../docs/pbcwrapper.html">PBC Wrapper</a>
        </li>
          </ul>
          <h5>Lattice</h5>
        <ul>
              
  
  <li class="none">
    
          <a href="../docs/lattice/mp12.html">Trapdoors [MP'12]</a>
        </li>
          </ul>
          <h5>Schemes</h5>
        <ul>
              
          
              
      
            
      
            
      
            
      
            
      
            
            
            
      
              
          
  <li class="expanded">
    
          <a href="../schemes/schemes.html#fe">Functional Encryption</a>
                <ul>
                  
  
  <li class="none">
    
          <a href="../schemes/abe_gghsw13.html">ABE for Circuits [GGHSW'13]</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../schemes/abe_gghvv13.html">ABE for Circuits [GGHVV'13]</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../schemes/rl_w12.html">Regular Languages [W'12]</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../schemes/uhibe_lw11.html">Unbounded HIBE [LW'11]</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../schemes/ip_lostw10.html">Inner Product [LOSTW'10]</a>
        </li>
                  
  
  <li class="none">
    
          <strong>Anonymous HIBE [DIP'10]</strong>
        </li>
                  
  
  <li class="none">
    
          <a href="../schemes/hve_ip08.html">HVE [IP'08]</a>
        </li>
              </ul>
        </li>
              
          
              
      
            
      
              
      
  <li class="expanded">
    
          <a href="../schemes/schemes.html#ss">Signature</a>
                <ul>
                  
  
  <li class="none">
    
          <a href="../schemes/ss_bls01.html">SS [BLS'01]</a>
        </li>
                  
  
  <li class="none">
    
          <a href="../schemes/ibs_ps06.html">IBS [PS'06]</a>
        </li>
              </ul>
        </li>
              
  
  <li class="none">
    
          <a href="../schemes/kem.html">KEM</a>
        </li>
          </ul>
          <h5>Project Documentation</h5>
        <ul>
              
                
              
      
            
      
            
      
            
      
              
      
  <li class="collapsed">
    
          <a href="../project-info.html">Project Information</a>
              </li>
          </ul>
                     
                               
  

  
    
            
  
        </div>
    </div>
    <div id="bodyColumn">
      <div style="clear:right;visibility:hidden"></div>
      <div id="contentBox">
        
    
        <div class="section">
<h2>Fully Secure Anonymous HIBE and Secret-Key Anonymous IBE with Short Ciphertexts<a name="Fully_Secure_Anonymous_HIBE_and_Secret-Key_Anonymous_IBE_with_Short_Ciphertexts"></a></h2>
            
<div class="section">
<h3>Authors<a name="Authors"></a></h3>
                A. De Caro and V. Iovino and G. Persiano
            </div>

            
<div class="section">
<h3>Abstract<a name="Abstract"></a></h3>
                Lewko and Waters [Eurocrypt 2010] presented a fully secure HIBE
                with short ciphertexts.  In this paper we show how to modify
                their construction to achieve anonymity.
                We prove the security of our scheme under static (and generically secure)
                assumptions formulated in composite order bilinear groups.

                In addition, we present a
                fully secure Anonymous IBE in the secret-key setting.
                Secret-Key Anonymous IBE was implied by the work of
                [Shen-Shi-Waters - TCC 2009] which can be shown secure
                in the selective-id model.
                No previous fully secure construction of secret-key Anonymous IBE is known.
            </div>

            
<div class="section">
<h3>URL<a name="URL"></a></h3>
                <a class="externalLink" href="http://eprint.iacr.org/2010/197.pdf">
                    http://eprint.iacr.org/2010/197.pdf
                </a>
            </div>
        </div>

        
<div class="section">
<h2>Usage<a name="Usage"></a></h2>

<div>
<pre>

<a name="l1"><span class="ln">1    </span></a><span class="s0">package </span><span class="s1">it.unisa.dia.gas.crypto.arcanum.fe.ibe.dip10;
<a name="l2"><span class="ln">2    </span></a>
<a name="l3"><span class="ln">3    </span></a></span><span class="s0">import </span><span class="s1">it.unisa.dia.gas.crypto.arcanum.fe.ibe.dip10.engines.AHIBEDIP10KEMEngine;
<a name="l4"><span class="ln">4    </span></a></span><span class="s0">import </span><span class="s1">it.unisa.dia.gas.crypto.arcanum.fe.ibe.dip10.generators.AHIBEDIP10KeyPairGenerator;
<a name="l5"><span class="ln">5    </span></a></span><span class="s0">import </span><span class="s1">it.unisa.dia.gas.crypto.arcanum.fe.ibe.dip10.generators.AHIBEDIP10SecretKeyGenerator;
<a name="l6"><span class="ln">6    </span></a></span><span class="s0">import </span><span class="s1">it.unisa.dia.gas.crypto.arcanum.fe.ibe.dip10.params.*;
<a name="l7"><span class="ln">7    </span></a></span><span class="s0">import </span><span class="s1">it.unisa.dia.gas.crypto.kem.KeyEncapsulationMechanism;
<a name="l8"><span class="ln">8    </span></a></span><span class="s0">import </span><span class="s1">Element;
<a name="l9"><span class="ln">9    </span></a></span><span class="s0">import </span><span class="s1">Pairing;
<a name="l10"><span class="ln">10   </span></a></span><span class="s0">import </span><span class="s1">PairingFactory;
<a name="l11"><span class="ln">11   </span></a></span><span class="s0">import </span><span class="s1">org.bouncycastle.crypto.AsymmetricCipherKeyPair;
<a name="l12"><span class="ln">12   </span></a></span><span class="s0">import </span><span class="s1">org.bouncycastle.crypto.CipherParameters;
<a name="l13"><span class="ln">13   </span></a></span><span class="s0">import </span><span class="s1">org.bouncycastle.crypto.InvalidCipherTextException;
<a name="l14"><span class="ln">14   </span></a>
<a name="l15"><span class="ln">15   </span></a></span><span class="s0">import </span><span class="s1">java.util.Arrays;
<a name="l16"><span class="ln">16   </span></a>
<a name="l17"><span class="ln">17   </span></a></span><span class="s0">import static </span><span class="s1">org.junit.Assert.*;
<a name="l18"><span class="ln">18   </span></a>
<a name="l19"><span class="ln">19   </span></a>
<a name="l20"><span class="ln">20   </span></a></span><span class="s2">/**
<a name="l21"><span class="ln">21   </span></a> * </span><span class="s3">@author </span><span class="s2">Angelo De Caro (arcanumlib@gmail.com)
<a name="l22"><span class="ln">22   </span></a> */</span><span class="s1">
<a name="l23"><span class="ln">23   </span></a></span><span class="s0">public class </span><span class="s1">AHIBEDIP10 {
<a name="l24"><span class="ln">24   </span></a>
<a name="l25"><span class="ln">25   </span></a>
<a name="l26"><span class="ln">26   </span></a>    </span><span class="s0">public </span><span class="s1">AHIBEDIP10() {
<a name="l27"><span class="ln">27   </span></a>    }
<a name="l28"><span class="ln">28   </span></a>
<a name="l29"><span class="ln">29   </span></a>
<a name="l30"><span class="ln">30   </span></a>    </span><span class="s0">public </span><span class="s1">AsymmetricCipherKeyPair setup(</span><span class="s0">int </span><span class="s1">bitLength, </span><span class="s0">int </span><span class="s1">length) {
<a name="l31"><span class="ln">31   </span></a>        AHIBEDIP10KeyPairGenerator setup = </span><span class="s0">new </span><span class="s1">AHIBEDIP10KeyPairGenerator();
<a name="l32"><span class="ln">32   </span></a>        setup.init(</span><span class="s0">new </span><span class="s1">AHIBEDIP10KeyPairGenerationParameters(bitLength, length));
<a name="l33"><span class="ln">33   </span></a>
<a name="l34"><span class="ln">34   </span></a>        </span><span class="s0">return </span><span class="s1">setup.generateKeyPair();
<a name="l35"><span class="ln">35   </span></a>    }
<a name="l36"><span class="ln">36   </span></a>
<a name="l37"><span class="ln">37   </span></a>    </span><span class="s0">public </span><span class="s1">Element[] map(CipherParameters publicKey, String... ids) {
<a name="l38"><span class="ln">38   </span></a>        Pairing pairing = PairingFactory.getPairing(((AHIBEDIP10PublicKeyParameters) publicKey).getParameters());
<a name="l39"><span class="ln">39   </span></a>
<a name="l40"><span class="ln">40   </span></a>        Element[] elements = </span><span class="s0">new </span><span class="s1">Element[ids.length];
<a name="l41"><span class="ln">41   </span></a>        </span><span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s1">; i &lt; elements.length; i++) {
<a name="l42"><span class="ln">42   </span></a>            </span><span class="s0">byte</span><span class="s1">[] id = ids[i].getBytes();
<a name="l43"><span class="ln">43   </span></a>            elements[i] = pairing.getZr().newElementFromHash(id, </span><span class="s4">0</span><span class="s1">, id.length);
<a name="l44"><span class="ln">44   </span></a>        }
<a name="l45"><span class="ln">45   </span></a>        </span><span class="s0">return </span><span class="s1">elements;
<a name="l46"><span class="ln">46   </span></a>    }
<a name="l47"><span class="ln">47   </span></a>
<a name="l48"><span class="ln">48   </span></a>
<a name="l49"><span class="ln">49   </span></a>    </span><span class="s0">public </span><span class="s1">CipherParameters keyGen(AsymmetricCipherKeyPair masterKey, Element... ids) {
<a name="l50"><span class="ln">50   </span></a>        AHIBEDIP10SecretKeyGenerator generator = </span><span class="s0">new </span><span class="s1">AHIBEDIP10SecretKeyGenerator();
<a name="l51"><span class="ln">51   </span></a>        generator.init(</span><span class="s0">new </span><span class="s1">AHIBEDIP10SecretKeyGenerationParameters(
<a name="l52"><span class="ln">52   </span></a>                (AHIBEDIP10MasterSecretKeyParameters) masterKey.getPrivate(),
<a name="l53"><span class="ln">53   </span></a>                (AHIBEDIP10PublicKeyParameters) masterKey.getPublic(),
<a name="l54"><span class="ln">54   </span></a>                ids
<a name="l55"><span class="ln">55   </span></a>        ));
<a name="l56"><span class="ln">56   </span></a>
<a name="l57"><span class="ln">57   </span></a>        </span><span class="s0">return </span><span class="s1">generator.generateKey();
<a name="l58"><span class="ln">58   </span></a>    }
<a name="l59"><span class="ln">59   </span></a>
<a name="l60"><span class="ln">60   </span></a>    </span><span class="s0">public </span><span class="s1">CipherParameters delegate(AsymmetricCipherKeyPair masterKey, CipherParameters secretKey, Element id) {
<a name="l61"><span class="ln">61   </span></a>        AHIBEDIP10SecretKeyGenerator generator = </span><span class="s0">new </span><span class="s1">AHIBEDIP10SecretKeyGenerator();
<a name="l62"><span class="ln">62   </span></a>        generator.init(</span><span class="s0">new </span><span class="s1">AHIBEDIP10DelegateGenerationParameters(
<a name="l63"><span class="ln">63   </span></a>                (AHIBEDIP10PublicKeyParameters) masterKey.getPublic(),
<a name="l64"><span class="ln">64   </span></a>                (AHIBEDIP10SecretKeyParameters) secretKey,
<a name="l65"><span class="ln">65   </span></a>                id
<a name="l66"><span class="ln">66   </span></a>        ));
<a name="l67"><span class="ln">67   </span></a>
<a name="l68"><span class="ln">68   </span></a>        </span><span class="s0">return </span><span class="s1">generator.generateKey();
<a name="l69"><span class="ln">69   </span></a>    }
<a name="l70"><span class="ln">70   </span></a>
<a name="l71"><span class="ln">71   </span></a>    </span><span class="s0">public byte</span><span class="s1">[][] encaps(CipherParameters publicKey, Element... ids) {
<a name="l72"><span class="ln">72   </span></a>        </span><span class="s0">try </span><span class="s1">{
<a name="l73"><span class="ln">73   </span></a>            KeyEncapsulationMechanism kem = </span><span class="s0">new </span><span class="s1">AHIBEDIP10KEMEngine();
<a name="l74"><span class="ln">74   </span></a>            kem.init(</span><span class="s0">true</span><span class="s1">, </span><span class="s0">new </span><span class="s1">AHIBEDIP10EncryptionParameters((AHIBEDIP10PublicKeyParameters) publicKey, ids));
<a name="l75"><span class="ln">75   </span></a>
<a name="l76"><span class="ln">76   </span></a>            </span><span class="s0">byte</span><span class="s1">[] ciphertext = kem.process();
<a name="l77"><span class="ln">77   </span></a>
<a name="l78"><span class="ln">78   </span></a>            assertNotNull(ciphertext);
<a name="l79"><span class="ln">79   </span></a>            assertNotSame(</span><span class="s4">0</span><span class="s1">, ciphertext.length);
<a name="l80"><span class="ln">80   </span></a>
<a name="l81"><span class="ln">81   </span></a>            </span><span class="s0">byte</span><span class="s1">[] key = Arrays.copyOfRange(ciphertext, </span><span class="s4">0</span><span class="s1">, kem.getKeyBlockSize());
<a name="l82"><span class="ln">82   </span></a>            </span><span class="s0">byte</span><span class="s1">[] ct = Arrays.copyOfRange(ciphertext, kem.getKeyBlockSize(), ciphertext.length);
<a name="l83"><span class="ln">83   </span></a>
<a name="l84"><span class="ln">84   </span></a>            </span><span class="s0">return new byte</span><span class="s1">[][]{key, ct};
<a name="l85"><span class="ln">85   </span></a>        } </span><span class="s0">catch </span><span class="s1">(InvalidCipherTextException e) {
<a name="l86"><span class="ln">86   </span></a>            e.printStackTrace();
<a name="l87"><span class="ln">87   </span></a>            fail(e.getMessage());
<a name="l88"><span class="ln">88   </span></a>        }
<a name="l89"><span class="ln">89   </span></a>        </span><span class="s0">return null</span><span class="s1">;
<a name="l90"><span class="ln">90   </span></a>    }
<a name="l91"><span class="ln">91   </span></a>
<a name="l92"><span class="ln">92   </span></a>    </span><span class="s0">public byte</span><span class="s1">[] decaps(CipherParameters secretKey, </span><span class="s0">byte</span><span class="s1">[] cipherText) {
<a name="l93"><span class="ln">93   </span></a>        </span><span class="s0">try </span><span class="s1">{
<a name="l94"><span class="ln">94   </span></a>            KeyEncapsulationMechanism kem = </span><span class="s0">new </span><span class="s1">AHIBEDIP10KEMEngine();
<a name="l95"><span class="ln">95   </span></a>
<a name="l96"><span class="ln">96   </span></a>            kem.init(</span><span class="s0">false</span><span class="s1">, secretKey);
<a name="l97"><span class="ln">97   </span></a>            </span><span class="s0">byte</span><span class="s1">[] key = kem.processBlock(cipherText);
<a name="l98"><span class="ln">98   </span></a>
<a name="l99"><span class="ln">99   </span></a>            assertNotNull(key);
<a name="l100"><span class="ln">100  </span></a>            assertNotSame(</span><span class="s4">0</span><span class="s1">, key.length);
<a name="l101"><span class="ln">101  </span></a>
<a name="l102"><span class="ln">102  </span></a>            </span><span class="s0">return </span><span class="s1">key;
<a name="l103"><span class="ln">103  </span></a>        } </span><span class="s0">catch </span><span class="s1">(InvalidCipherTextException e) {
<a name="l104"><span class="ln">104  </span></a>            e.printStackTrace();
<a name="l105"><span class="ln">105  </span></a>            fail(e.getMessage());
<a name="l106"><span class="ln">106  </span></a>        }
<a name="l107"><span class="ln">107  </span></a>
<a name="l108"><span class="ln">108  </span></a>        </span><span class="s0">return null</span><span class="s1">;
<a name="l109"><span class="ln">109  </span></a>    }
<a name="l110"><span class="ln">110  </span></a>
<a name="l111"><span class="ln">111  </span></a>
<a name="l112"><span class="ln">112  </span></a>    </span><span class="s0">public static void </span><span class="s1">main(String[] args) {
<a name="l113"><span class="ln">113  </span></a>        AHIBEDIP10 engine = </span><span class="s0">new </span><span class="s1">AHIBEDIP10();
<a name="l114"><span class="ln">114  </span></a>
<a name="l115"><span class="ln">115  </span></a>        </span><span class="s2">// Setup</span><span class="s1">
<a name="l116"><span class="ln">116  </span></a>        AsymmetricCipherKeyPair keyPair = engine.setup(</span><span class="s4">64</span><span class="s1">, </span><span class="s4">3</span><span class="s1">);
<a name="l117"><span class="ln">117  </span></a>
<a name="l118"><span class="ln">118  </span></a>        </span><span class="s2">// KeyGen</span><span class="s1">
<a name="l119"><span class="ln">119  </span></a>        Element[] ids = engine.map(keyPair.getPublic(), </span><span class="s5">&quot;angelo&quot;</span><span class="s1">, </span><span class="s5">&quot;de caro&quot;</span><span class="s1">, </span><span class="s5">&quot;unisa&quot;</span><span class="s1">);
<a name="l120"><span class="ln">120  </span></a>
<a name="l121"><span class="ln">121  </span></a>        CipherParameters sk0 = engine.keyGen(keyPair, ids[</span><span class="s4">0</span><span class="s1">]);
<a name="l122"><span class="ln">122  </span></a>        CipherParameters sk01 = engine.keyGen(keyPair, ids[</span><span class="s4">0</span><span class="s1">], ids[</span><span class="s4">1</span><span class="s1">]);
<a name="l123"><span class="ln">123  </span></a>        CipherParameters sk012 = engine.keyGen(keyPair, ids[</span><span class="s4">0</span><span class="s1">], ids[</span><span class="s4">1</span><span class="s1">], ids[</span><span class="s4">2</span><span class="s1">]);
<a name="l124"><span class="ln">124  </span></a>
<a name="l125"><span class="ln">125  </span></a>        CipherParameters sk1 = engine.keyGen(keyPair, ids[</span><span class="s4">1</span><span class="s1">]);
<a name="l126"><span class="ln">126  </span></a>        CipherParameters sk10 = engine.keyGen(keyPair, ids[</span><span class="s4">1</span><span class="s1">], ids[</span><span class="s4">0</span><span class="s1">]);
<a name="l127"><span class="ln">127  </span></a>        CipherParameters sk021 = engine.keyGen(keyPair, ids[</span><span class="s4">0</span><span class="s1">], ids[</span><span class="s4">2</span><span class="s1">], ids[</span><span class="s4">1</span><span class="s1">]);
<a name="l128"><span class="ln">128  </span></a>
<a name="l129"><span class="ln">129  </span></a>        </span><span class="s2">// Encryption/Decryption</span><span class="s1">
<a name="l130"><span class="ln">130  </span></a>        </span><span class="s0">byte</span><span class="s1">[][] ciphertext0 = engine.encaps(keyPair.getPublic(), ids[</span><span class="s4">0</span><span class="s1">]);
<a name="l131"><span class="ln">131  </span></a>        </span><span class="s0">byte</span><span class="s1">[][] ciphertext01 = engine.encaps(keyPair.getPublic(), ids[</span><span class="s4">0</span><span class="s1">], ids[</span><span class="s4">1</span><span class="s1">]);
<a name="l132"><span class="ln">132  </span></a>        </span><span class="s0">byte</span><span class="s1">[][] ciphertext012 = engine.encaps(keyPair.getPublic(), ids[</span><span class="s4">0</span><span class="s1">], ids[</span><span class="s4">1</span><span class="s1">], ids[</span><span class="s4">2</span><span class="s1">]);
<a name="l133"><span class="ln">133  </span></a>
<a name="l134"><span class="ln">134  </span></a>        </span><span class="s2">// Decrypt</span><span class="s1">
<a name="l135"><span class="ln">135  </span></a>        assertEquals(</span><span class="s0">true</span><span class="s1">, Arrays.equals(ciphertext0[</span><span class="s4">0</span><span class="s1">], engine.decaps(sk0, ciphertext0[</span><span class="s4">1</span><span class="s1">])));
<a name="l136"><span class="ln">136  </span></a>        assertEquals(</span><span class="s0">true</span><span class="s1">, Arrays.equals(ciphertext01[</span><span class="s4">0</span><span class="s1">], engine.decaps(sk01, ciphertext01[</span><span class="s4">1</span><span class="s1">])));
<a name="l137"><span class="ln">137  </span></a>        assertEquals(</span><span class="s0">true</span><span class="s1">, Arrays.equals(ciphertext012[</span><span class="s4">0</span><span class="s1">], engine.decaps(sk012, ciphertext012[</span><span class="s4">1</span><span class="s1">])));
<a name="l138"><span class="ln">138  </span></a>
<a name="l139"><span class="ln">139  </span></a>        assertEquals(</span><span class="s0">false</span><span class="s1">, Arrays.equals(ciphertext0[</span><span class="s4">0</span><span class="s1">], engine.decaps(sk1, ciphertext0[</span><span class="s4">1</span><span class="s1">])));
<a name="l140"><span class="ln">140  </span></a>        assertEquals(</span><span class="s0">false</span><span class="s1">, Arrays.equals(ciphertext01[</span><span class="s4">0</span><span class="s1">], engine.decaps(sk10, ciphertext01[</span><span class="s4">1</span><span class="s1">])));
<a name="l141"><span class="ln">141  </span></a>        assertEquals(</span><span class="s0">false</span><span class="s1">, Arrays.equals(ciphertext012[</span><span class="s4">0</span><span class="s1">], engine.decaps(sk021, ciphertext012[</span><span class="s4">1</span><span class="s1">])));
<a name="l142"><span class="ln">142  </span></a>
<a name="l143"><span class="ln">143  </span></a>        </span><span class="s2">// Delegate/Decrypt</span><span class="s1">
<a name="l144"><span class="ln">144  </span></a>        assertEquals(</span><span class="s0">true</span><span class="s1">, Arrays.equals(ciphertext01[</span><span class="s4">0</span><span class="s1">], engine.decaps(engine.delegate(keyPair, sk0, ids[</span><span class="s4">1</span><span class="s1">]), ciphertext01[</span><span class="s4">1</span><span class="s1">])));
<a name="l145"><span class="ln">145  </span></a>        assertEquals(</span><span class="s0">true</span><span class="s1">, Arrays.equals(ciphertext012[</span><span class="s4">0</span><span class="s1">], engine.decaps(engine.delegate(keyPair, sk01, ids[</span><span class="s4">2</span><span class="s1">]), ciphertext012[</span><span class="s4">1</span><span class="s1">])));
<a name="l146"><span class="ln">146  </span></a>        assertEquals(</span><span class="s0">true</span><span class="s1">, Arrays.equals(ciphertext012[</span><span class="s4">0</span><span class="s1">], engine.decaps(engine.delegate(keyPair, engine.delegate(keyPair, sk0, ids[</span><span class="s4">1</span><span class="s1">]), ids[</span><span class="s4">2</span><span class="s1">]), ciphertext012[</span><span class="s4">1</span><span class="s1">])));
<a name="l147"><span class="ln">147  </span></a>
<a name="l148"><span class="ln">148  </span></a>        assertEquals(</span><span class="s0">false</span><span class="s1">, Arrays.equals(ciphertext01[</span><span class="s4">0</span><span class="s1">], engine.decaps(engine.delegate(keyPair, sk0, ids[</span><span class="s4">0</span><span class="s1">]), ciphertext01[</span><span class="s4">1</span><span class="s1">])));
<a name="l149"><span class="ln">149  </span></a>        assertEquals(</span><span class="s0">false</span><span class="s1">, Arrays.equals(ciphertext012[</span><span class="s4">0</span><span class="s1">], engine.decaps(engine.delegate(keyPair, sk01, ids[</span><span class="s4">1</span><span class="s1">]), ciphertext012[</span><span class="s4">1</span><span class="s1">])));
<a name="l150"><span class="ln">150  </span></a>        assertEquals(</span><span class="s0">false</span><span class="s1">, Arrays.equals(ciphertext012[</span><span class="s4">0</span><span class="s1">], engine.decaps(engine.delegate(keyPair, engine.delegate(keyPair, sk0, ids[</span><span class="s4">2</span><span class="s1">]), ids[</span><span class="s4">1</span><span class="s1">]), ciphertext012[</span><span class="s4">1</span><span class="s1">])));
<a name="l151"><span class="ln">151  </span></a>    }
<a name="l152"><span class="ln">152  </span></a>
<a name="l153"><span class="ln">153  </span></a>
<a name="l154"><span class="ln">154  </span></a>}</span></pre></div>
</div>

    

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="license">
          <a rel="license" href="http://creativecommons.org/licenses/by-nc/2.5/">
              <img
                  alt="Creative Commons License" src="http://creativecommons.org/images/public/somerights20.gif"
                  id="license_image"/>
          </a>
          Except where otherwise noted, content on this site is
          licensed under a
          <a style="border-bottom-style: groove;" rel="license" href="http://creativecommons.org/licenses/by/2.5/" class="subfoot">
              Creative Commons Attribution 2.5 License
          </a>
          &#169;  
          2014
    
          
  

  
    
            
  
        </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
